"use strict";(self["webpackChunksanyue_imghub"]=self["webpackChunksanyue_imghub"]||[]).push([[588],{1536:function(e,s,a){a.d(s,{A:function(){return $}});var i=a(6975),t=a(47),o=(a(5331),a(9648),a(9623)),n=(a(6711),a(813)),r=(a(4896),a(6658)),l=a(8027),d=a(6768),u=a(4232),c=a(5130);const m={class:"login-page"},g={class:"login-container"},p={class:"login-header"},h={class:"login-title"},k={class:"login-form"},b={class:"form-label"},f={key:0,class:"loading-spinner"},y={key:1};function v(e,s,a,v,w,L){const A=l.A,C=r.A,F=n.tk,$=o.WK,_=t.S2,S=i.A;return(0,d.uX)(),(0,d.CE)("div",m,[(0,d.bF)(A,{class:"toggle-dark"}),(0,d.bF)(C),(0,d.Lk)("div",g,[(0,d.Lk)("div",p,[(0,d.Lk)("h1",h,(0,u.v_)(a.title),1),s[0]||(s[0]=(0,d.Lk)("p",{class:"login-subtitle"},"欢迎回来，请登录以继续",-1))]),(0,d.Lk)("div",k,[((0,d.uX)(!0),(0,d.CE)(d.FK,null,(0,d.pI)(a.fields,(e,s)=>((0,d.uX)(),(0,d.CE)("div",{key:e.key,class:"form-group"},[(0,d.Lk)("label",b,(0,u.v_)(e.label),1),(0,d.bF)($,{modelValue:w.formData[e.key],"onUpdate:modelValue":s=>w.formData[e.key]=s,placeholder:e.placeholder,type:e.type||"text","show-password":e.showPassword,class:"form-input",onKeyup:(0,c.jR)(L.handleSubmit,["enter","native"]),size:"large"},(0,d.eX)({_:2},[e.icon?{name:"prefix",fn:(0,d.k6)(()=>[(0,d.bF)(F,{class:"input-icon"},{default:(0,d.k6)(()=>[((0,d.uX)(),(0,d.Wv)((0,d.$y)(e.icon)))]),_:2},1024)]),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue","placeholder","type","show-password","onKeyup"])]))),128)),(0,d.bF)(_,{class:(0,u.C4)(["submit-btn",{"is-loading":a.loading}]),type:"primary",onClick:L.handleSubmit,disabled:a.loading,size:"large"},{default:(0,d.k6)(()=>[a.loading?((0,d.uX)(),(0,d.CE)("div",f)):((0,d.uX)(),(0,d.CE)("span",y,(0,u.v_)(a.submitText),1))]),_:1},8,["class","onClick","disabled"])])]),(0,d.bF)(S,{class:"footer"})])}a(8111),a(7588);var w=a(8401),L=a(8903),A={name:"BaseLogin",mixins:[L.A],props:{title:{type:String,required:!0},fields:{type:Array,required:!0},submitText:{type:String,default:"登录"},backgroundKey:{type:String,required:!0},isAdmin:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},data(){return{formData:{}}},computed:{...(0,w.L8)(["userConfig"])},watch:{fields:{handler(){this.initFormData()},immediate:!0}},components:{Footer:i.A,ToggleDark:l.A,Logo:r.A},mounted(){this.initializeBackground(this.backgroundKey,".login-page",!this.isAdmin,!0)},methods:{initFormData(){const e={};this.fields.forEach(s=>{e[s.key]=""}),this.formData=e},handleSubmit(){this.loading||this.$emit("submit",{...this.formData})}}},C=a(1241);const F=(0,C.A)(A,[["render",v],["__scopeId","data-v-7b971b90"]]);var $=F},3950:function(e,s,a){a.r(s),a.d(s,{default:function(){return u}});var i=a(1536),t=a(6768);function o(e,s,a,o,n,r){const l=i.A;return(0,t.uX)(),(0,t.Wv)(l,{title:"管理端登录",fields:n.loginFields,"submit-text":"登录","background-key":"adminLoginBkImg","is-admin":!0,loading:n.isLoading,onSubmit:r.handleLogin},null,8,["fields","loading","onSubmit"])}a(4114),a(4979);var n=a(457),r={data(){return{isLoading:!1,loginFields:[{key:"username",label:"用户名",placeholder:"请输入用户名",type:"text",icon:"User"},{key:"password",label:"密码",placeholder:"请输入密码",type:"password",showPassword:!0,icon:"Lock"}]}},components:{BaseLogin:i.A},methods:{async handleLogin(e){const{username:s,password:a}=e,i=btoa(`${s}:${a}`);this.isLoading=!0;const t=new Promise(e=>setTimeout(e,1e3)),o=n.A.get("/api/manage/check",{headers:{Authorization:`Basic ${i}`},withCredentials:!0}).then(e=>({response:e})).catch(e=>({error:e}));try{const[e]=await Promise.all([o,t]);if(e.response&&200===e.response.status)this.$store.commit("setCredentials",i),this.$router.push("/dashboard");else{const s=e.error||new Error("Unknown error");this.isLoading=!1,s.response&&401===s.response.status?this.$message.error("用户名或密码错误"):this.$message.error("服务器错误")}}catch(r){this.isLoading=!1,this.$message.error("系统错误")}}}},l=a(1241);const d=(0,l.A)(r,[["render",o]]);var u=d}}]);
//# sourceMappingURL=588.9d7ecc7c.js.map