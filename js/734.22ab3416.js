"use strict";(self["webpackChunksanyue_imghub"]=self["webpackChunksanyue_imghub"]||[]).push([[734],{1536:function(e,i,s){s.d(i,{A:function(){return S}});var t=s(6975),a=s(47),o=(s(5331),s(9648),s(9623)),n=(s(6711),s(813)),l=(s(4896),s(6658)),r=s(8027),d=s(6768),u=s(4232),c=s(5130);const g={class:"login-page"},m={class:"login-container"},h={class:"login-header"},p={class:"login-title"},f={class:"login-form"},k={class:"form-label"},b={key:0,class:"loading-spinner"},y={key:1};function v(e,i,s,v,w,L){const A=r.A,C=l.A,F=n.tk,S=o.WK,_=a.S2,D=t.A;return(0,d.uX)(),(0,d.CE)("div",g,[(0,d.bF)(A,{class:"toggle-dark"}),(0,d.bF)(C),(0,d.Lk)("div",m,[(0,d.Lk)("div",h,[(0,d.Lk)("h1",p,(0,u.v_)(s.title),1),i[0]||(i[0]=(0,d.Lk)("p",{class:"login-subtitle"},"欢迎回来，请登录以继续",-1))]),(0,d.Lk)("div",f,[((0,d.uX)(!0),(0,d.CE)(d.FK,null,(0,d.pI)(s.fields,(e,i)=>((0,d.uX)(),(0,d.CE)("div",{key:e.key,class:"form-group"},[(0,d.Lk)("label",k,(0,u.v_)(e.label),1),(0,d.bF)(S,{modelValue:w.formData[e.key],"onUpdate:modelValue":i=>w.formData[e.key]=i,placeholder:e.placeholder,type:e.type||"text","show-password":e.showPassword,class:"form-input",onKeyup:(0,c.jR)(L.handleSubmit,["enter","native"]),size:"large"},(0,d.eX)({_:2},[e.icon?{name:"prefix",fn:(0,d.k6)(()=>[(0,d.bF)(F,{class:"input-icon"},{default:(0,d.k6)(()=>[((0,d.uX)(),(0,d.Wv)((0,d.$y)(e.icon)))]),_:2},1024)]),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue","placeholder","type","show-password","onKeyup"])]))),128)),(0,d.bF)(_,{class:(0,u.C4)(["submit-btn",{"is-loading":s.loading}]),type:"primary",onClick:L.handleSubmit,disabled:s.loading,size:"large"},{default:(0,d.k6)(()=>[s.loading?((0,d.uX)(),(0,d.CE)("div",b)):((0,d.uX)(),(0,d.CE)("span",y,(0,u.v_)(s.submitText),1))]),_:1},8,["class","onClick","disabled"])])]),(0,d.bF)(D,{class:"footer"})])}s(8111),s(7588);var w=s(8401),L=s(8903),A={name:"BaseLogin",mixins:[L.A],props:{title:{type:String,required:!0},fields:{type:Array,required:!0},submitText:{type:String,default:"登录"},backgroundKey:{type:String,required:!0},isAdmin:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},data(){return{formData:{}}},computed:{...(0,w.L8)(["userConfig"])},watch:{fields:{handler(){this.initFormData()},immediate:!0}},components:{Footer:t.A,ToggleDark:r.A,Logo:l.A},mounted(){this.initializeBackground(this.backgroundKey,".login-page",!this.isAdmin,!0)},methods:{initFormData(){const e={};this.fields.forEach(i=>{e[i.key]=""}),this.formData=e},handleSubmit(){this.loading||this.$emit("submit",{...this.formData})}}},C=s(1241);const F=(0,C.A)(A,[["render",v],["__scopeId","data-v-7b971b90"]]);var S=F},2560:function(e,i,s){s.r(i),s.d(i,{default:function(){return m}});var t=s(1536),a=s(6768);function o(e,i,s,o,n,l){const r=t.A;return(0,a.uX)(),(0,a.Wv)(r,{title:l.loginTitle,fields:n.loginFields,"submit-text":"登录","background-key":"loginBkImg","is-admin":!1,loading:n.isLoading,onSubmit:l.handleLogin},null,8,["title","fields","loading","onSubmit"])}s(4114);var n=s(4570),l=s.n(n),r=s(457),d=s(8401),u={data(){return{isLoading:!1,loginFields:[{key:"password",label:"密码",placeholder:"请输入认证码",type:"password",showPassword:!0,icon:"Lock"}]}},computed:{...(0,d.L8)(["userConfig"]),ownerName(){return this.userConfig?.ownerName||"Sanyue"},loginTitle(){return`登录到 ${this.ownerName} 图床`}},components:{BaseLogin:t.A},methods:{async handleLogin(e){const{password:i}=e,s=""===i?"unset":i;this.isLoading=!0;const t=new Promise(e=>setTimeout(e,500)),a=r.A.post("/api/login",{authCode:i}).then(e=>({res:e})).catch(e=>({err:e}));try{const[e]=await Promise.all([a,t]);e.res&&200===e.res.status?(l().set("authCode",s,"14d"),this.$router.push("/"),this.$message.success("登录成功")):(this.isLoading=!1,this.$message.error("登录失败，请检查密码是否正确"))}catch(o){this.isLoading=!1,this.$message.error("系统错误")}}}},c=s(1241);const g=(0,c.A)(u,[["render",o]]);var m=g}}]);
//# sourceMappingURL=734.22ab3416.js.map