"use strict";(self["webpackChunksanyue_imghub"]=self["webpackChunksanyue_imghub"]||[]).push([[309],{1424:function(e,t,o){o.d(t,{A:function(){return f}});var a=o(6768),i=o(4232),n=o(5130);const s={class:"text-center mb-6"},r={class:"text-h4 font-weight-bold primary--text login-title"};function l(e,t,o,l,d,c){const u=(0,a.g2)("ToggleDark"),g=(0,a.g2)("Logo"),m=(0,a.g2)("v-text-field"),p=(0,a.g2)("v-btn"),h=(0,a.g2)("v-form"),b=(0,a.g2)("v-card"),f=(0,a.g2)("v-col"),k=(0,a.g2)("v-row"),y=(0,a.g2)("Footer"),v=(0,a.g2)("v-container");return(0,a.uX)(),(0,a.Wv)(v,{fluid:"",class:"fill-height login pa-0"},{default:(0,a.k6)(()=>[(0,a.bF)(u,{class:"toggle-dark"}),(0,a.bF)(g,{class:"logo-pos"}),(0,a.bF)(k,{align:"center",justify:"center",class:"fill-height ma-0"},{default:(0,a.k6)(()=>[(0,a.bF)(f,{cols:"12",sm:"8",md:"6",lg:"4",xl:"3"},{default:(0,a.k6)(()=>[(0,a.bF)(b,{class:"login-card elevation-24 px-6 py-8",rounded:"xl"},{default:(0,a.k6)(()=>[(0,a.Lk)("div",s,[(0,a.Lk)("h1",r,(0,i.v_)(o.title),1)]),(0,a.bF)(h,{onSubmit:(0,n.D$)(c.handleSubmit,["prevent"])},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.fields,(e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:e.key,class:"mb-4"},[(0,a.bF)(m,{modelValue:d.formData[e.key],"onUpdate:modelValue":t=>d.formData[e.key]=t,label:e.label,placeholder:e.placeholder,type:e.type||"text","append-inner-icon":"Lock"===e.icon?"mdi-lock":void 0,variant:"outlined",color:"primary",density:"comfortable",loading:o.loading,rounded:"lg",class:"login-input","bg-color":"surface"},null,8,["modelValue","onUpdate:modelValue","label","placeholder","type","append-inner-icon","loading"])]))),128)),(0,a.bF)(p,{block:"",color:"primary",size:"x-large",rounded:"lg",elevation:"4",class:"mt-6 text-capitalize font-weight-bold tracking-wide",loading:o.loading,type:"submit"},{default:(0,a.k6)(()=>[(0,a.eW)((0,i.v_)(o.submitText),1)]),_:1},8,["loading"])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1}),(0,a.bF)(y,{class:"footer"})]),_:1})}o(8111),o(7588);var d=o(2922),c=o(4417),u=o(9237),g=o(782),m=o(8065),p={name:"BaseLogin",mixins:[m.A],props:{title:{type:String,required:!0},fields:{type:Array,required:!0},submitText:{type:String,default:"登录"},backgroundKey:{type:String,required:!0},isAdmin:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},data(){return{formData:{}}},computed:{...(0,g.L8)(["userConfig"])},components:{Footer:d.A,ToggleDark:c.A,Logo:u.A},created(){this.initFormData()},mounted(){this.initializeBackground(this.backgroundKey,".login",!this.isAdmin,!0)},methods:{initFormData(){const e={};this.fields.forEach(t=>{e[t.key]=""}),this.formData=e},handleSubmit(){this.loading||this.$emit("submit",{...this.formData})}}},h=o(1241);const b=(0,h.A)(p,[["render",l],["__scopeId","data-v-ac56c014"]]);var f=b},4565:function(e,t,o){o.r(t),o.d(t,{default:function(){return c}});var a=o(6768);function i(e,t,o,i,n,s){const r=(0,a.g2)("BaseLogin");return(0,a.uX)(),(0,a.Wv)(r,{title:"管理端登录",fields:n.loginFields,"submit-text":"登录","background-key":"adminLoginBkImg","is-admin":!0,loading:n.isLoading,onSubmit:s.handleLogin},null,8,["fields","loading","onSubmit"])}o(4114),o(4979);var n=o(1424),s=o(635),r={data(){return{isLoading:!1,loginFields:[{key:"username",label:"用户名",placeholder:"请输入用户名",type:"text",icon:"User"},{key:"password",label:"密码",placeholder:"请输入密码",type:"password",showPassword:!0,icon:"Lock"}]}},components:{BaseLogin:n.A},methods:{async handleLogin(e){const{username:t,password:o}=e,a=btoa(`${t}:${o}`);this.isLoading=!0;const i=new Promise(e=>setTimeout(e,1e3)),n=s.A.get("/api/manage/check",{headers:{Authorization:`Basic ${a}`},withCredentials:!0}).then(e=>({response:e})).catch(e=>({error:e}));try{const[e]=await Promise.all([n,i]);if(e.response&&200===e.response.status)this.$store.commit("setCredentials",a),this.$router.push("/dashboard");else{const t=e.error||new Error("Unknown error");this.isLoading=!1,t.response&&401===t.response.status?this.$message.error("用户名或密码错误"):this.$message.error("服务器错误")}}catch(r){this.isLoading=!1,this.$message.error("系统错误")}}}},l=o(1241);const d=(0,l.A)(r,[["render",i]]);var c=d}}]);
//# sourceMappingURL=309.878ee11e.js.map