"use strict";(self["webpackChunksanyue_imghub"]=self["webpackChunksanyue_imghub"]||[]).push([[574],{1424:function(e,t,o){o.d(t,{A:function(){return b}});var i=o(6768),a=o(4232),n=o(5130);const l={class:"text-center mb-6"},s={class:"text-h4 font-weight-bold primary--text login-title"};function r(e,t,o,r,d,u){const g=(0,i.g2)("ToggleDark"),c=(0,i.g2)("Logo"),m=(0,i.g2)("v-text-field"),h=(0,i.g2)("v-btn"),p=(0,i.g2)("v-form"),f=(0,i.g2)("v-card"),b=(0,i.g2)("v-col"),k=(0,i.g2)("v-row"),y=(0,i.g2)("Footer"),v=(0,i.g2)("v-container");return(0,i.uX)(),(0,i.Wv)(v,{fluid:"",class:"fill-height login pa-0"},{default:(0,i.k6)(()=>[(0,i.bF)(g,{class:"toggle-dark"}),(0,i.bF)(c,{class:"logo-pos"}),(0,i.bF)(k,{align:"center",justify:"center",class:"fill-height ma-0"},{default:(0,i.k6)(()=>[(0,i.bF)(b,{cols:"12",sm:"8",md:"6",lg:"4",xl:"3"},{default:(0,i.k6)(()=>[(0,i.bF)(f,{class:"login-card elevation-24 px-6 py-8",rounded:"xl"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",l,[(0,i.Lk)("h1",s,(0,a.v_)(o.title),1)]),(0,i.bF)(p,{onSubmit:(0,n.D$)(u.handleSubmit,["prevent"])},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.fields,(e,t)=>((0,i.uX)(),(0,i.CE)("div",{key:e.key,class:"mb-4"},[(0,i.bF)(m,{modelValue:d.formData[e.key],"onUpdate:modelValue":t=>d.formData[e.key]=t,label:e.label,placeholder:e.placeholder,type:e.type||"text","append-inner-icon":"Lock"===e.icon?"mdi-lock":void 0,variant:"outlined",color:"primary",density:"comfortable",loading:o.loading,rounded:"lg",class:"login-input","bg-color":"surface"},null,8,["modelValue","onUpdate:modelValue","label","placeholder","type","append-inner-icon","loading"])]))),128)),(0,i.bF)(h,{block:"",color:"primary",size:"x-large",rounded:"lg",elevation:"4",class:"mt-6 text-capitalize font-weight-bold tracking-wide",loading:o.loading,type:"submit"},{default:(0,i.k6)(()=>[(0,i.eW)((0,a.v_)(o.submitText),1)]),_:1},8,["loading"])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1}),(0,i.bF)(y,{class:"footer"})]),_:1})}o(8111),o(7588);var d=o(2922),u=o(4417),g=o(9237),c=o(782),m=o(8065),h={name:"BaseLogin",mixins:[m.A],props:{title:{type:String,required:!0},fields:{type:Array,required:!0},submitText:{type:String,default:"登录"},backgroundKey:{type:String,required:!0},isAdmin:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},data(){return{formData:{}}},computed:{...(0,c.L8)(["userConfig"])},components:{Footer:d.A,ToggleDark:u.A,Logo:g.A},created(){this.initFormData()},mounted(){this.initializeBackground(this.backgroundKey,".login",!this.isAdmin,!0)},methods:{initFormData(){const e={};this.fields.forEach(t=>{e[t.key]=""}),this.formData=e},handleSubmit(){this.loading||this.$emit("submit",{...this.formData})}}},p=o(1241);const f=(0,p.A)(h,[["render",r],["__scopeId","data-v-ac56c014"]]);var b=f},8254:function(e,t,o){o.r(t),o.d(t,{default:function(){return m}});var i=o(6768);function a(e,t,o,a,n,l){const s=(0,i.g2)("BaseLogin");return(0,i.uX)(),(0,i.Wv)(s,{title:l.loginTitle,fields:n.loginFields,"submit-text":"登录","background-key":"loginBkImg","is-admin":!1,loading:n.isLoading,onSubmit:l.handleLogin},null,8,["title","fields","loading","onSubmit"])}o(4114);var n=o(4570),l=o.n(n),s=o(635),r=o(782),d=o(1424),u={data(){return{isLoading:!1,loginFields:[{key:"password",label:"密码",placeholder:"请输入认证码",type:"password",showPassword:!0,icon:"Lock"}]}},computed:{...(0,r.L8)(["userConfig"]),ownerName(){return this.userConfig?.ownerName||"Sanyue"},loginTitle(){return`登录到 ${this.ownerName} 图床`}},components:{BaseLogin:d.A},methods:{async handleLogin(e){const{password:t}=e,o=""===t?"unset":t;this.isLoading=!0;const i=new Promise(e=>setTimeout(e,500)),a=s.A.post("/api/login",{authCode:t}).then(e=>({res:e})).catch(e=>({err:e}));try{const[e]=await Promise.all([a,i]);e.res&&200===e.res.status?(l().set("authCode",o,"14d"),this.$router.push("/"),this.$message.success("登录成功")):(this.isLoading=!1,this.$message.error("登录失败，请检查密码是否正确"))}catch(n){this.isLoading=!1,this.$message.error("系统错误")}}}},g=o(1241);const c=(0,g.A)(u,[["render",a]]);var m=c}}]);
//# sourceMappingURL=574.9f33deba.js.map